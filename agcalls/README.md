# Комплексный алгоритм транскрипции и классификации аудиозвонков


Приветствую!

Перед вами -- комплексный алгоритм транскрипции и классификации аудиозвонков.

Предположим,  компании, которая занимается продажей и обслуживанием автомобилей, нужно снизить нагрузку на колл-центры, перенаправляя звонки в нужные отделы автоматически.

В связи с чем возникают, например, следующие категории звонков:
* Продажа автомобиля,
* Покупка автомобиля,
* Сервис и обслуживание автомобиля,
* Кузовной ремонт,
* Финансовые вопросы (например, по кредитам),
* Вопрос оператору (когда без него не обойтись),
* Нецелевой звонок (когда и оператора не стоит беспокоить).


### Видео-демонстрация алгоритма

Видео-демонстрацию алгоритма можно увидеть в [скринкасте](https://dzen.ru/video/watch/684efc3bca1db06f075aac9c?share_to=link).

<details>
<summary>Нажмите, чтобы открыть содержание видео-ролика</summary>

Содержание видео-ролика, демонстрирующего работу алгоритма.

**00:01 Введение в алгоритм транскрипции и классификации аудиозвонков**
1. Демонстрация работы комплексного алгоритма транскрипции и классификации аудиозвонков.
2. Пример использования для компании по продаже и обслуживанию автомобилей.
3. Категории звонков: продажа автомобиля, покупка автомобиля, сервис и обслуживание, кузовной ремонт, финансовые вопросы, вопросы оператору, нецелевые звонки.

**00:57 Доступ к алгоритму через Docker и браузер**

1. Доступ к алгоритму через Docker-контейнер и API.
2. Возможность использования графического интерфейса в браузере Edge.
3. Инструкция по запуску через каталог Docker и демо-ключ.

**01:35 Классификация текста и аудиофайлов**
1. Пример классификации текста на первой вкладке приложения.
2. Загрузка звукового файла и запуск процесса транскрипции и классификации.
3. Поддержка различных форматов аудиофайлов.

**02:34 Транскрипция и классификация аудиофайла**
1. Пример транскрипции и классификации 20-секундного аудиофайла.
2. Уверенность классификации составляет 86%.
3. Проверка транскрипции и прослушивание очищенного файла.

**03:31 Удаление шумов и анализ звука**
1. Удаление шумов из аудиофайла.
2. Сравнение графиков звука до и после обработки.
3. Тепловые карты показывают улучшение качества голосовых частот.

**05:16 Аугментация речи и проверка модели**
1. Добавление смысловой неразборчивости в нормальную речь.
2. Запись и запуск процесса транскрипции.
3. Результат: категория "кузовной ремонт" с уверенностью более 93%.

</details>

После запуска докер-контейнера алгоритм доступен как по API, так и в графическом интерфейсе в браузере EDGE (где он работает корректно). 



### Задачи, которые призван выполнять алгоритм

Описание задач этого проекта и инструментов их выполнения -- в [этом репозитории](https://github.com/gravek/my_projects/blob/main/agcalls/Задачи%20по%20автоматизации%20обработке%20звонков.md).

Сгенерированный для до-обучения модели классификации датасет находится -- в [этом репозитории](https://github.com/gravek/my_projects/blob/main/agcalls/train_sentences.csv)


### Качество обучения модели классификации

accuracy:   0.9889  
precision_macro:    0.9884  
recall_macro:   0.9894  
f1_macro:   0.9887  


### О Docker-контейнере

Инструкции по запуску контейнера -- также в [этом репозитории](https://github.com/gravek/my_projects/blob/main/agcalls/Краткая%20документация-инструкция%20по%20запуску%20демо-контейнера%20и%20API.md).



<details>
<summary>Нажмите, чтобы открыть описание файлов в контейнере</summary>

`api_app.py`:
Модуль для обработки аудиофайлов (транскрипция, шумоподавление, визуализация) и классификации текста с использованием моделей ONNX и SentenceTransformer.

`api_server.py`:
FastAPI-сервер для приема аудиофайлов, их транскрипции и классификации с асинхронной обработкой через Celery, включая API-аутентификацию и логирование.

`demo_app.py`:
Gradio-интерфейс для демонстрации классификации текста и транскрипции аудиофайлов с визуализацией результатов и кэшированием.

`model.onnx`:
Оптимизированная ONNX-модель для классификации текста по категориям звонков.

`requirements.txt`:
Список зависимостей Python, необходимых для работы сервиса, включая библиотеки для аудиообработки, машинного обучения и веб-интерфейса.

`supervisord.conf`:
Конфигурационный файл Supervisord для управления процессами API-сервера и демо-приложения в контейнере.

`test_api.py`:
Модуль с тестами для проверки классификации текста и работы эндпоинта API с использованием фиктивных данных.


`Dockerfile`:
Файл сборки Docker-образа, включающий установку зависимостей, копирование моделей и настройку окружения для запуска сервиса.

</details>


## Расширенный контекст применения алгоритма

Например, пайплайн может быть таким.

Звонки клиентов автодилеру в текстовом виде:
* классифицируются по 6 категориям (на обученной модели)
* для каждого класса создается суммаризация (GPT4)
* кластеризируются (с автоматическим расчетом кол-ва кластеров)
* суммаризируется каждый кластер

Пример такой обработки звонков приведен в ноутбуке -- в [этом репозитории](https://github.com/gravek/my_projects/blob/main/agcalls/Классификация%2C%20кластеризация%20и%20AI%20суммаризация%20звонков.ipynb).

Результат выполненной AI суммаризации на сгенерированном датасете со звонками приведен под споллйром:
<details>
<summary>Нажмите, чтобы его увидеть</summary>

### Суммаризация по классам

#### **Класс: Покупка автомобиля**

**Обобщение: **  
Клиенты интересуются различными аспектами приобретения автомобилей, от связи с менеджером по продажам до покупки машин в кредит или в рассрочку, а также ищут информацию о ценах, скидках и программах трейд-ин.

**Ключевые пункты:**  
1) Связь с менеджером по продажам,  
2) Покупка автомобиля в кредит или рассрочку,  
3) Интерес к ценам и скидкам,  
4) Интерес к новым и подержанным автомобилям.


#### **Класс: Сервис и обслуживание автомобиля**

**Обобщение: **  
Клиенты автосервиса заинтересованы в проведении различных технических работ, включая диагностику и ремонт двигателя, замену масла и фильтров, а также в решении проблем с электрооборудованием и системами автомобиля. Они также выражают беспокойство по поводу времени выполнения услуг и наличия гарантии на ремонт.

**Ключевые пункты:**  
1) Диагностика и ремонт двигателя,  
2) Замена масла, фильтров, и тормозных колодок,  
3) Решение проблем с электрооборудованием,  
4) Время выполнения услуг и наличие гарантии на ремонт.


#### **Класс: Кузовной ремонт**

**Обобщение: **  
Клиенты интересуются сроками и стоимостью кузовного ремонта после аварий, включая покраску, замену и вытяжку различных частей автомобиля.

**Ключевые пункты:**  
1) Ремонт и покраска кузовных деталей,  
2) Замена поврежденных стекол и фар,  
3) Вытяжка и устранение вмятин,  
4) Запросы на оценку стоимости услуг.


#### **Класс: Финансовые вопросы**

**Обобщение: **  
Клиенты интересуются условиями оформления автокредита и страхования автомобиля, включая процентные ставки, переплату по кредиту, ежемесячные платежи и программы лояльности. Также их волнует возможность оформления каско и необходимые документы для получения кредита.

**Ключевые пункты:**  
1) Условия и процентные ставки по автокредиту,  
2) Условия и программы страхования автомобиля,  
3) Необходимые документы для оформления кредита,  
4) Программы лояльности и переплата по кредиту.


#### **Класс: Вопрос оператору**

**Обобщение: **
Клиенты интересуются местоположением автосалона и сервиса, графиком их работы, а также контактной информацией для связи с различными отделами, включая отдел продаж и бухгалтерию. Кроме того, их интересуют способы оплаты и проверки статуса заявок, а также возможность добраться общественным транспортом.


**Ключевые пункты:**  
1) Местоположение и график работы автосалона и сервиса,  
2) Контактная информация для связи с разными отделами,  
3) Способы проверки и оплаты,  
4) Информация о доступности общественного транспорта.


#### **Класс: Нецелевой звонок**

**Обобщение: **
Клиенты часто ошибаются при наборе номера, связываясь с различными организациями и службами, такими как автомойка, прачечная, служба доставки и магазин автозапчастей, или попадают на рекламные звонки и спам. Основные проблемы включают:

**Ключевые пункты:**  
1) частые ошибки при наборе номера,  
2) попадание на рекламные звонки и спам,  
3) связь с неправильными организациями,  
4) необходимость перезвона для уточнения информации.



### Суммаризация по кластерам

#### Cluster 0:

Клиенты интересуются различными аспектами сервиса и покупки автомобилей: они спрашивают о сроках и стоимости кузовного ремонта, покраски детали, а также проявляют интерес к различным моделям и комплектациям автомобилей, особенно с автоматической коробкой передач, уделяя особое внимание марке Volkswagen Polo.


#### Cluster 1:

Клиенты интересуются расположением и графиком работы автосалона, а также контактами и способами связи с отделом продаж и сервисом. Они также хотят узнать, как добраться до салона, оставить или проверить статус заявки, и нуждаются в информации о сайте компании.


#### Cluster 2:

Клиенты интересуются различными аспектами обслуживания, включая просмотр автомобильного каталога, проверку остатка по кредиту, способы оплаты кредита, а также способы связи с отделами бухгалтерии, кредитования и продаж для получения информации о статусе заявки и условиях кредитов. Они также ищут информацию о том, как можно оплатить кредит онлайн или через интернет.




</details>






